
‚úÖ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç ble_lock_set_pin.py
–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–µ—Ç PIN-–∫–æ–¥ –∑–∞–º–∫–∞, –∏—Å–ø–æ–ª—å–∑—É—è BLE-–∑–∞—Ö–≤–∞—Ç (pcapng), –≤ –∫–æ—Ç–æ—Ä–æ–º –µ—Å—Ç—å —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏–µ:

–ò–∑–≤–ª–µ–∫–∞–µ—Ç SKDm, SKDs –∏ IV –∏–∑ capture.pcapng.

–§–æ—Ä–º–∏—Ä—É–µ—Ç TLV —Å –Ω–æ–≤—ã–º PIN –∏ —Å—á–∏—Ç–∞–µ—Ç CRC16.

–®–∏—Ñ—Ä—É–µ—Ç –ø–æ —Å—Ö–µ–º–µ AES-CTR, –∫–∞–∫ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ Tuya Smart.

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã delete –∏ create —á–µ—Ä–µ–∑ Tuya OpenAPI.

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ø–µ—à–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É PIN –ø–æ DP unlock_password.

üì¶ 1. –ö–∞–∫ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å BLE-–∑–∞—Ö–≤–∞—Ç
–ö–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —Ç—ã —Ö–æ—á–µ—à—å –ø–æ–º–µ–Ω—è—Ç—å PIN:

–∑–∞–ø—É—Å–∫–∞–µ—à—å Wireshark 



–ª–æ–≤–∏—à—å 5‚Äì10 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∑–∞–º–∫–∞ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é Tuya Smart.

                -----------–í–∞–∂–Ω–æ –¥–æ –≤–∫–ª—é—á–µ–Ω–∏—è –∑–∞–º–∫–∞ –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –ª–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç—ã!-------------

—Å–æ—Ö—Ä–∞–Ω—è–µ—à—å —Ñ–∞–π–ª –∫–∞–∫ capture.pcapng –∏ –∫–ª–∞–¥—ë—à—å —Ä—è–¥–æ–º —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º.

--------‚ö†Ô∏è –í–∞–∂–Ω–æ: —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è –∏–º–µ–Ω–Ω–æ capture.pcapng ‚Äî —Ç–∞–∫ –æ–∂–∏–¥–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç.-------
–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–µ –∏–º—è ‚Äî –ø—Ä–æ—Å—Ç–æ –∑–∞–º–µ–Ω–∏ "capture.pcapng" –≤ —Å–∫—Ä–∏–ø—Ç–µ.

üõ†Ô∏è 2. –ß—Ç–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ —Å–∫—Ä–∏–ø—Ç–µ --------—è —É–∂–µ —Å–¥–µ–ª–∞–ª –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—å –Ω–∞ –≤—Å—è–∫–∏–π --------------
–í —Å–∞–º–æ–º ble_lock_set_pin.py:


ACCESS_ID    = "..."      # –¢–≤–æ–π API ID –æ—Ç Tuya
ACCESS_KEY   = "..."      # –¢–≤–æ–π Secret Key
DEVICE_ID    = "..."      # ID —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–∑–∞–º–∫–∞)
LOCAL_KEY    = b"..."     # 16-–±–∞–π—Ç–æ–≤—ã–π local_key –∑–∞–º–∫–∞
NEW_PIN      = "124578"   # –ù–æ–≤—ã–π PIN-–∫–æ–¥ (6 —Ü–∏—Ñ—Ä)
PASSWORD_ID  = 1          # ID —Å–ª–æ—Ç–∞, –æ–±—ã—á–Ω–æ 1
–í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî —É–∂–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–æ, —Ç—Ä–æ–≥–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ.
–í—Å–µ —à–∞–≥–∏ –ø–æ–º–µ—á–µ–Ω—ã –≤ –∫–æ–¥–µ –∫–∞–∫ –®–ê–ì 1, –®–ê–ì 2 –∏ —Ç.–¥. —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏.

üì• 3. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –µ—â—ë –Ω–µ —Å—Ç–∞–≤–∏–ª)
                                                            -------------–û–¥–∏–Ω —Ä–∞–∑ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏:-------------------

-----------–∫–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ –æ—Ç–¥–µ–ª—å–Ω–æ –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ --- –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –∫–æ–º–∞–Ω–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ä–∞–∑—É —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –ø–æ—Ç–æ–º —É–∂–µ –ø–µ—Ä–µ—Ö–æ–¥ –≤ –ø–∞–ø–∫—É —Å —Ñ–∞–π–ª–∞–º–∏--------

Python 3.10.11 –Ω—É–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞–ª –Ω–∞ –Ω–µ–π –Ω–æ –º–æ–π —Å–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç Python 3.7‚Äì3.12 –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª –Ω–æ –ø–æ –∫–æ–¥—É –¥–æ–ª–∂–µ–Ω

python --version     —ç—Ç–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–æ–∂–Ω–æ –∫–∞–∫–∞—è —É –≤–∞—Å –≤–µ—Ä—Å–∏—è, –µ—Å–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —É–¥–∞–ª–∏—Ç–µ –µ–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–º–µ—Å—Ç–∏ —Å –ø–∞–ø–∫–∞–º–∏ –≤ –ø—Ä–æ—Ñ–∏–ª—å, –∑–∞–π–¥–µ—Ç–µ –≤–∞—à–µ –∏–º—è –Ω–∞ –¥–∏—Å–∫–µ —Å –Ω–∞–π–¥–µ—Ç–µ —Ç–∞–º  AppData —Ç–æ–∂–µ –ø–æ–¥—á–∏—Å—Ç–∏—Ç–µ –ø–∞–ø–∫–∞ python –±—É–¥–µ—Ç —É–¥–∞–ª—è–π—Ç–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω—É–∂–Ω—É—é –≤–µ—Ä—Å–∏—è!

–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ 

pip install tuya-connector-python pycryptodome crcmod    -----------–ø–µ—Ä–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ----------

pip install pyshark                   ----------------PyShark / TShark –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç pyshark. –ù—É–∂–Ω–æ, —á—Ç–æ–±—ã –Ω–∞ –ü–ö —Å—Ç–æ—è–ª Wireshark/TShark (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ Runtime).

                                                                     –ï—Å–ª–∏ TShark –Ω–µ –≤ PATH, PyShark –≤—ã–±—Ä–æ—Å–∏—Ç –æ—à–∏–±–∫—É.

                                                       ----¬´–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Wireshark ‚â• 3.4 –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ tshark –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏¬ª.----



pip install tuya-iot-py-sdk   –≤—Ç–æ—Ä–∞—è üîß Tuya SDK ‚Äî –Ω–µ –Ω—É–∂–µ–Ω –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –Ω–æ —É –º–µ–Ω—è –±—ã–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ –≤—Å—è–∫–∏–π —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º–∞–ª–æ –≤–µ—Å–∏—Ç!

pip install rich             üåà rich ‚Äî –∫—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ –ª–æ–≥–æ–≤ –≤ –∫–æ–Ω—Å–æ–ª–∏

pip install ipython        üß† ipython ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –æ–±–æ–ª–æ—á–∫–∞ Python. –û—á–µ–Ω—å —É–¥–æ–±–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏ —Ä–∞–±–æ—Ç—ã —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º –≤–∂–∏–≤—É—é.




----------–§–∞–π–ª –∑–∞—Ö–≤–∞—Ç–∞-----------

–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±–∞ –ø–∞–∫–µ—Ç–∞ LL_ENC_REQ / LL_ENC_RSP.

–ò–º—è –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é capture.pcapng; –ø—Ä–∏ –¥—Ä—É–≥–æ–º –∏–º–µ–Ω–∏ –Ω—É–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å PCAP_FILE.


üöÄ 4. –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

python ble_lock_set_pin.py               –ù–£ –°–ê–ú–û –°–û–ë–û–ô –í –ö–û–ù–°–û–õ–ò –ö–û–ú–ê–ù–î–ê cd –ø—É—Ç—å_–¥–æ_–ø–∞–ø–∫–∏ python ble_lock_set_pin.py
–ï—Å–ª–∏ –≤—Å—ë –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ, —Ç—ã —É–≤–∏–¥–∏—à—å:



-------------  LOCAL_KEY  --------------

–î–æ–ª–∂–µ–Ω –±—ã—Ç—å 16 –±–∞–π—Ç, –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤, –≤ –≤–∏–¥–µ b"...".

–ï—Å–ª–∏  –±—É–¥–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –∑–∞–º–æ–∫ ‚Äî –Ω–∞–¥–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –µ–≥–æ local_key.
                      

                                             ------------------------------–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è--------------------------------

                                   –ó–∞–º–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–Ω–ª–∞–π–Ω –≤ –º–æ–º–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞.
üéâ PIN –ø—Ä–∏–º–µ–Ω—ë–Ω, –≤–≤–µ–¥–∏—Ç–µ 124578 –Ω–∞ –∑–∞–º–∫–µ!
üìå –∫–æ—Ä–æ—Ç–∫–æ:
–ß—Ç–æ	–ù—É–∂–Ω–æ
üîÅ –ù–æ–≤—ã–π PIN	NEW_PIN –≤ —Å–∫—Ä–∏–ø—Ç–µ
üìÑ –ù–æ–≤—ã–π –∑–∞—Ö–≤–∞—Ç	capture.pcapng —Ä—è–¥–æ–º —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º
üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏	–≤—ã—à–µ —Å–º–æ—Ç—Ä–µ—Ç—å
üí¨ –Ø–∑—ã–∫	Python 3.10.11 

